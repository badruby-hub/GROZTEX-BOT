const { PrismaClient } = require("@prisma/client");
const TelegramBot = require("node-telegram-bot-api");
require('dotenv').config();
const token = process.env.BOT_TOKEN;
const bot = new TelegramBot(token, { polling: true });
const prisma = new PrismaClient();
bot.on("message", async (msg) => {
  const chatId = msg.chat.id;
  const userName = msg.from.username;
  const firstName = msg.from.first_name;
  const lastName = msg.from.last_name;
  
  const text = msg.text;

  if (text === "/start") { //–û–¢–í–ï–¢ –°–¢–ê–†–¢ 
    await bot.sendMessage(
      chatId,`
–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ GROZTEX üìç –ú–∞–ª–≥–æ–±–µ–∫—Å–∫–∞—è —É–ª–∏—Ü–∞, 19, –ì—Ä–æ–∑–Ω—ã–π, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –ß–µ—á–Ω—è

üìÖ –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 10:00 –¥–æ 00:00 –ø–æ –ú–°–ö

üíµ –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º —Ç–æ–ª—å–∫–æ –∑–∞ –Ω–∞–ª–∏—á–Ω—ã–µ —Ä—É–±–ª–∏

üíπ –°–∞–º—ã–π –Ω–∏–∑–∫–∏–π –∫—É—Ä—Å –Ω–∞ –ø–æ–∫—É–ø–∫—É USDT –∏ –ª—É—á—à–∏–π –∫—É—Ä—Å –ø–æ–∫—É–ø–∫–∏ USDT –≤ –ß–µ—á–Ω–µ

ü§ë –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–∞–∫–æ–π –ª–∏–±–æ –∫–æ–º–∏—Å—Å–∏–∏ –Ω–∞ –ø–æ–∫—É–ø–∫—É –∏ –ø—Ä–æ–¥–∞–∂—É USDT

–î–ª—è –ø–æ–∫—É–ø–∫–∏ USDT –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–û–±–º–µ–Ω"`,{
                parse_mode: "HTML",
                reply_markup:{
                  keyboard: [
                    [{text:'üè¶ –û –Ω–∞—Å'},{text:'üìä –ö—É—Ä—Å—ã'}],
                    [{text:'üì≤ –°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏'},{text:'üîé AML –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—à–µ–ª—å–∫–∞'}],
                    [{text:'üìä –ë–∏—Ä–∂–∞'}],
                  ],
                  resize_keyboard:true,
                }
              }
    );
    await prisma.user.upsert({
        where: {chatId: BigInt(chatId)},
        update:{
            userName: userName,
            firstName: firstName,
            lastName: lastName,
        },
        create:{
        chatId: BigInt(chatId),
        userName: userName,
        firstName: firstName,
        lastName: lastName,
        
        }
    })
  }else if(text === "üè¶ –û –Ω–∞—Å") { //–û–¢–í–ï–¢ –û –ù–ê–° 
         await bot.sendMessage(
      chatId,`
ü§ñ –û –Ω–∞—Å

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –±–æ—Ç –¥–ª—è –æ–±–º–µ–Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã!

üí∞ –ú—ã –∑–∞–Ω–∏–º–∞–µ–º—Å—è –æ–±–º–µ–Ω–æ–º –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç –±–æ–ª–µ–µ 3—Ö –ª–µ—Ç.

üìÖ –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 10:00 –¥–æ 00:00 –ø–æ –ú–°–ö.

üíµ –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º —Ç–æ–ª—å–∫–æ –∑–∞ –Ω–∞–ª–∏—á–Ω—ã–µ —Ä—É–±–ª–∏.

üíπ –£ –Ω–∞—Å –≤—ã –º–æ–∂–µ—Ç–µ –∫—É–ø–∏—Ç—å USDT –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏ –ø–æ —Å–∞–º–æ–º—É –ª—É—á—à–µ–º—É –∫—É—Ä—Å—É –≤ –ß–µ—á–Ω–µ.

–ù–∞—à –∞–¥—Ä–µ—Å:
–ú–∞–ª–≥–æ–±–µ–∫—Å–∫–∞—è —É–ª–∏—Ü–∞, 19, –ì—Ä–æ–∑–Ω—ã–π, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –ß–µ—á–Ω—è

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏ –ø–æ–∫—É–ø–∫–∏ USDT, –≤–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.` 
    );
  }else if(text === "üìä –ö—É—Ä—Å—ã"){ //–û–¢–í–ï–¢ –ö–£–†–°–´ 
    try {
      const response = await fetch("https://moscaex.online/api2/usdt_rate");
      const data = await response.json();
      const apiBuy = parseFloat(data.buy); 
      const apiSell = parseFloat(data.sell);
      const buy = (apiBuy + 0.5).toFixed(2);
      const sell = (apiSell - 0.5).toFixed(2);

      
      await bot.sendMessage(
   chatId, `
–ö—É—Ä—Å –æ–±–º–µ–Ω–∞ —Ä—É–±–ª–µ–π –Ω–∞ USDT:

üíµ –ö—É–ø–∏—Ç—å 1 USDT = ${buy} RUB
üíµ –ü—Ä–æ–¥–∞—Ç—å 1 USDT = ${sell} RUB

üö® –î–∞–Ω–Ω—ã–π –∫—É—Ä—Å —è–≤–ª—è–µ—Ç—Å—è –±–∏—Ä–∂–µ–≤—ã–º –∏ –º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

–ö–æ–º–º–∏—Å–∏–∏ –Ω–µ—Ç –∑–∞ –≤—ã–≤–æ–¥ USDT –≤ —Å–µ—Ç–∏ Tron

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏ –ø–æ–∫—É–ø–∫–∏ USDT, –≤–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É - –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–û–±–º–µ–Ω"

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
  GROZTEX
   `
    )
    } catch (error) {
      
    }
    
  }else if (text === "üì≤ –°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏"){
    await bot.sendMessage(
      chatId, `
–ù–∞—à–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –Ω–∞ —Å–≤—è–∑–∏ 24/7 –∏ –≥–æ—Ç–æ–≤—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã

–î–ª—è —Å–≤—è–∑–∏ —Å –Ω–∞–º–∏ –Ω–∞–ø–∏—à–∏—Ç–µ  - <a href="https://t.me/GROZTEX">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏ –ø–æ–∫—É–ø–∫–∏ USDT, –≤–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É - –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–û–±–º–µ–Ω"

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
  GROZTEX
      `,
      {
      parse_mode: "HTML",
      disable_web_page_preview: true
      },

    )
  }else if(text === "üìä –ë–∏—Ä–∂–∞"){ //–û–¢–í–ï–¢ –ë–ò–†–ñ–ê
    await bot.sendMessage(
    chatId, `
–° —Ä–∞–¥–æ—Å—Ç—å—é —Å–æ–æ–±—â–∞–µ–º –í–∞–º –æ–± —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤–æ–µ–π –±–∏—Ä–∂–∏ ! üéâ

‚è≥ –í —Å–∫–æ—Ä–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–∞–π—Ç –Ω–∞—à–µ–π –±–∏—Ä–∂–∏ 

–ú—ã —Å—Ç—Ä–µ–º–∏–º—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞—à–∏–º –∫–ª–∏–µ–Ω—Ç–∞–º –ª—É—á—à–∏–π —Å–µ—Ä–≤–∏—Å –∏ –Ω–∞–¥–µ–∂–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —É—Å–ø–µ—à–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏. 

–ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏!

–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å ‚Äî –≤–º–µ—Å—Ç–µ —Å—Ç—Ä–æ–∏–º –±—É–¥—É—â–µ–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç! üöÄ

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
  GROZTEX
    `
    )
  }else if (text === "üîé AML –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—à–µ–ª—å–∫–∞"){ //–û–¢–í–ï–¢ –ê–ú–õ 
 await bot.sendMessage(
    chatId,`
‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—à–µ–ª—å–∫–∞ –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–∫–∞

–î–ª—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É‚Äî <a href="https://t.me/GROZTEX">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
  GROZTEX
    `,
    {
      parse_mode: "HTML",
      disable_web_page_preview: true
    }
 )
  }else{
    await bot.sendMessage(
      chatId,`
–ï—Å–ª–∏ —É –í–∞—Å –æ—Å—Ç–∞–ª–∏—Å—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å 
–≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É‚Äî <a href="https://t.me/GROZTEX">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
  GROZTEX
      `,
      {
        parse_mode: "HTML",
        disable_web_page_preview: true
      }
    )
  }
});
